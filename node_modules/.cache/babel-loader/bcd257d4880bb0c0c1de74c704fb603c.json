{"ast":null,"code":"import _objectSpread from \"/Users/benwang/Desktop/NYCU_CS/112spring/cloud/final/Cloudnative_Final_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/Users/benwang/Desktop/NYCU_CS/112spring/cloud/final/Cloudnative_Final_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/benwang/Desktop/NYCU_CS/112spring/cloud/final/Cloudnative_Final_project/src/pages/Dif_topic.js\";\nimport { Container, Grid, Item, Image, Icon } from \"semantic-ui-react\";\nimport React from \"react\";\nimport Topics from \"../compoments/Topic\";\nimport firebase from \"../utils/firebase\";\nimport { Link, useLocation } from \"react-router-dom\";\nfunction Dif_topic() {\n  var _this = this;\n  var location = useLocation();\n  var pathname = location.pathname;\n  var parts = pathname.split(\"/\");\n  var currentTopic = decodeURIComponent(parts[1]);\n  var _React$useState = React.useState([]),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    posts = _React$useState2[0],\n    setPosts = _React$useState2[1];\n  React.useEffect(function () {\n    firebase.firestore().collection(\"posts\").where(\"topic\", \"==\", currentTopic).get().then(function (collectionSnapshot) {\n      var data = collectionSnapshot.docs.map(function (docSnapshot) {\n        var id = docSnapshot.id;\n        return _objectSpread({}, docSnapshot.data(), {\n          id: id\n        });\n      });\n      setPosts(data);\n    });\n  }, [currentTopic]);\n  // eslint-disable-next-line\n  // function updateViewUser(postId) {\n  //   firebase\n  //     .firestore()\n  //     .collection(\"posts\")\n  //     .doc(postId)\n  //     .update({\n  //       viewUser: firebase.firestore.FieldValue.arrayUnion(\n  //         firebase.auth().currentUser.uid\n  //       ),\n  //     });\n  // }\n  function incrementViewCount(postId) {\n    firebase.firestore().collection(\"posts\").doc(postId).update({\n      viewCount: firebase.firestore.FieldValue.increment(1)\n    });\n  }\n  return /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Grid.Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Grid.Column, {\n    width: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Topics, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Grid.Column, {\n    width: 9,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Item.Group, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 13\n    }\n  }, posts.map(function (post) {\n    return /*#__PURE__*/React.createElement(Item, {\n      key: post.id,\n      as: Link,\n      to: \"/post/\".concat(post.id),\n      onClick: function onClick() {\n        return incrementViewCount(post.id);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Image, {\n      src: post.imageUrl,\n      size: \"tiny\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(Item.Content, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Item.Meta, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 23\n      }\n    }, post.author.photoURL ? /*#__PURE__*/React.createElement(Image, {\n      src: post.author.photoURL,\n      width: 25,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 27\n      }\n    }) : /*#__PURE__*/React.createElement(Icon, {\n      name: \"user circle\",\n      size: \"small\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 27\n      }\n    }), post.topic, \" \\u2022 \", post.author.name || \"匿名\", \" \\u2022\", \" \", post.cretedAt ? post.cretedAt.toDate().toLocaleString([], {\n      month: \"short\",\n      day: \"numeric\",\n      hour: \"2-digit\",\n      minute: \"2-digit\"\n    }) : \"2021-10-10 08:00 AM\"), /*#__PURE__*/React.createElement(Item.Header, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 23\n      }\n    }, post.title), /*#__PURE__*/React.createElement(Item.Description, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 23\n      }\n    }, post.content), /*#__PURE__*/React.createElement(Item.Extra, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 23\n      }\n    }, \"\\u4FEE\\u6539\\u6B21\\u6578 : \", post.updateCount || 0, \"\\u2022\", \" \", \"\\u89C0\\u770B\\u6B21\\u6578 : \", post.viewCount || 0)));\n  }))))));\n}\nexport default Dif_topic;","map":{"version":3,"names":["Container","Grid","Item","Image","Icon","React","Topics","firebase","Link","useLocation","Dif_topic","_this","location","pathname","parts","split","currentTopic","decodeURIComponent","_React$useState","useState","_React$useState2","_slicedToArray","posts","setPosts","useEffect","firestore","collection","where","get","then","collectionSnapshot","data","docs","map","docSnapshot","id","_objectSpread","incrementViewCount","postId","doc","update","viewCount","FieldValue","increment","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","Row","Column","width","Group","post","key","as","to","concat","onClick","src","imageUrl","size","Content","Meta","author","photoURL","name","topic","cretedAt","toDate","toLocaleString","month","day","hour","minute","Header","title","Description","content","Extra","updateCount"],"sources":["/Users/benwang/Desktop/NYCU_CS/112spring/cloud/final/Cloudnative_Final_project/src/pages/Dif_topic.js"],"sourcesContent":["import { Container, Grid, Item, Image, Icon } from \"semantic-ui-react\";\nimport React from \"react\";\nimport Topics from \"../compoments/Topic\";\nimport firebase from \"../utils/firebase\";\nimport { Link, useLocation } from \"react-router-dom\";\n\nfunction Dif_topic() {\n  const location = useLocation();\n  const pathname = location.pathname;\n  const parts = pathname.split(\"/\");\n  const currentTopic = decodeURIComponent(parts[1]);\n  const [posts, setPosts] = React.useState([]);\n  React.useEffect(() => {\n    firebase\n      .firestore()\n      .collection(\"posts\")\n      .where(\"topic\", \"==\", currentTopic)\n      .get()\n      .then((collectionSnapshot) => {\n        const data = collectionSnapshot.docs.map((docSnapshot) => {\n          const id = docSnapshot.id;\n          return { ...docSnapshot.data(), id };\n        });\n        setPosts(data);\n      });\n  }, [currentTopic]);\n  // eslint-disable-next-line\n  // function updateViewUser(postId) {\n  //   firebase\n  //     .firestore()\n  //     .collection(\"posts\")\n  //     .doc(postId)\n  //     .update({\n  //       viewUser: firebase.firestore.FieldValue.arrayUnion(\n  //         firebase.auth().currentUser.uid\n  //       ),\n  //     });\n  // }\n  function incrementViewCount(postId) {\n    firebase\n      .firestore()\n      .collection(\"posts\")\n      .doc(postId)\n\n      .update({\n        viewCount: firebase.firestore.FieldValue.increment(1),\n      });\n  }\n\n  return (\n    <Container>\n      <Grid>\n        <Grid.Row>\n          <Grid.Column width={3}>\n            <Topics />\n          </Grid.Column>\n          <Grid.Column width={9}>\n            <Item.Group>\n              {posts.map((post) => {\n                return (\n                  <Item\n                    key={post.id}\n                    as={Link}\n                    to={`/post/${post.id}`}\n                    onClick={() => incrementViewCount(post.id)}\n                  >\n                    <Image src={post.imageUrl} size=\"tiny\" />\n\n                    <Item.Content>\n                      <Item.Meta>\n                        {post.author.photoURL ? (\n                          <Image src={post.author.photoURL} width={25} />\n                        ) : (\n                          <Icon name=\"user circle\" size=\"small\" />\n                        )}\n                        {post.topic} • {post.author.name || \"匿名\"} •{\" \"}\n                        {post.cretedAt\n                          ? post.cretedAt.toDate().toLocaleString([], {\n                              month: \"short\",\n                              day: \"numeric\",\n                              hour: \"2-digit\",\n                              minute: \"2-digit\",\n                            })\n                          : \"2021-10-10 08:00 AM\"}\n                      </Item.Meta>\n\n                      <Item.Header>{post.title}</Item.Header>\n                      <Item.Description>{post.content}</Item.Description>\n                      <Item.Extra>\n                        {/* <a href={`/posts/${post.id}/edit`}> */}\n                        修改次數 : {post.updateCount || 0}\n                        {/* </a>{\" \"} */}•{\" \"}\n                        {/* <a href={`/posts/${post.id}`}> */}\n                        觀看次數 : {post.viewCount || 0}\n                        {/* </a> */}\n                      </Item.Extra>\n                    </Item.Content>\n                  </Item>\n                );\n              })}\n            </Item.Group>\n          </Grid.Column>\n        </Grid.Row>\n      </Grid>\n    </Container>\n  );\n}\n\nexport default Dif_topic;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}