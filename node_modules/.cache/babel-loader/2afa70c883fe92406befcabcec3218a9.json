{"ast":null,"code":"import _objectSpread from \"/Users/benwang/Desktop/NYCU_CS/112spring/cloud/final/Cloudnative_Final_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/Users/benwang/Desktop/NYCU_CS/112spring/cloud/final/Cloudnative_Final_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/benwang/Desktop/NYCU_CS/112spring/cloud/final/Cloudnative_Final_project/src/pages/Post.js\";\nimport { Container, Grid, Item, Image, Icon } from \"semantic-ui-react\";\nimport React from \"react\";\n// import Header from \"semantic-ui-react\";\nimport Topics from \"../compoments/Topic\";\nimport firebase from \"../utils/firebase\";\nimport { Link } from \"react-router-dom\";\nfunction Post() {\n  var _this = this;\n  var _React$useState = React.useState([]),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    posts = _React$useState2[0],\n    setPosts = _React$useState2[1];\n  React.useEffect(function () {\n    firebase.firestore().collection(\"posts\").get().then(function (collectionSnapshot) {\n      var data = collectionSnapshot.docs.map(function (docSnapshot) {\n        var id = docSnapshot.id;\n        return _objectSpread({}, docSnapshot.data(), {\n          id: id\n        });\n      });\n      setPosts(data);\n    });\n  }, []);\n  function incrementViewCount(postId) {\n    firebase.firestore().collection(\"posts\").doc(postId).update({\n      viewCount: firebase.firestore.FieldValue.increment(1)\n    });\n  }\n  return /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Grid.Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Grid.Column, {\n    width: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Topics, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Grid.Column, {\n    width: 9,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Item.Group, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 13\n    }\n  }, posts.map(function (post) {\n    return /*#__PURE__*/React.createElement(Item, {\n      key: post.id,\n      as: Link,\n      to: \"/post/\".concat(post.id),\n      onClick: function onClick() {\n        return incrementViewCount(post.id);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Image, {\n      src: post.imageUrl,\n      size: \"tiny\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(Item.Content, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Item.Meta, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 23\n      }\n    }, post.author.photoURL ? /*#__PURE__*/React.createElement(Image, {\n      src: post.author.photoURL,\n      width: 25,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 27\n      }\n    }) : /*#__PURE__*/React.createElement(Icon, {\n      name: \"user circle\",\n      size: \"small\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 27\n      }\n    }), post.topic, \" \\u2022 \", post.author.name || \"匿名\", \" \\u2022\", \" \", post.cretedAt ? post.cretedAt.toDate().toLocaleString([], {\n      year: \"numeric\",\n      month: \"short\",\n      day: \"numeric\",\n      hour: \"2-digit\",\n      minute: \"2-digit\"\n    }) : \"2021-10-10 08:00 AM\"), /*#__PURE__*/React.createElement(Item.Header, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 23\n      }\n    }, post.title), /*#__PURE__*/React.createElement(Item.Description, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 23\n      }\n    }, post.content), /*#__PURE__*/React.createElement(Item.Extra, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 23\n      }\n    }, \"\\u4FEE\\u6539\\u6B21\\u6578 : \", post.updateCount || 0, \"\\u89C0\\u770B\\u6B21\\u6578 : \", post.viewCount || 0)));\n  }))))));\n}\nexport default Post;","map":{"version":3,"names":["Container","Grid","Item","Image","Icon","React","Topics","firebase","Link","Post","_this","_React$useState","useState","_React$useState2","_slicedToArray","posts","setPosts","useEffect","firestore","collection","get","then","collectionSnapshot","data","docs","map","docSnapshot","id","_objectSpread","incrementViewCount","postId","doc","update","viewCount","FieldValue","increment","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","Row","Column","width","Group","post","key","as","to","concat","onClick","src","imageUrl","size","Content","Meta","author","photoURL","name","topic","cretedAt","toDate","toLocaleString","year","month","day","hour","minute","Header","title","Description","content","Extra","updateCount"],"sources":["/Users/benwang/Desktop/NYCU_CS/112spring/cloud/final/Cloudnative_Final_project/src/pages/Post.js"],"sourcesContent":["import { Container, Grid, Item, Image, Icon } from \"semantic-ui-react\";\r\nimport React from \"react\";\r\n// import Header from \"semantic-ui-react\";\r\nimport Topics from \"../compoments/Topic\";\r\nimport firebase from \"../utils/firebase\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nfunction Post() {\r\n  const [posts, setPosts] = React.useState([]);\r\n  React.useEffect(() => {\r\n    firebase\r\n      .firestore()\r\n      .collection(\"posts\")\r\n      .get()\r\n      .then((collectionSnapshot) => {\r\n        const data = collectionSnapshot.docs.map((docSnapshot) => {\r\n          const id = docSnapshot.id;\r\n          return { ...docSnapshot.data(), id };\r\n        });\r\n        setPosts(data);\r\n      });\r\n  }, []);\r\n\r\n  function incrementViewCount(postId) {\r\n    firebase\r\n      .firestore()\r\n      .collection(\"posts\")\r\n      .doc(postId)\r\n      .update({\r\n        viewCount: firebase.firestore.FieldValue.increment(1),\r\n      });\r\n  }\r\n\r\n  return (\r\n    <Container>\r\n      <Grid>\r\n        <Grid.Row>\r\n          <Grid.Column width={3}>\r\n            <Topics />\r\n          </Grid.Column>\r\n          <Grid.Column width={9}>\r\n            <Item.Group>\r\n              {posts.map((post) => {\r\n                return (\r\n                  <Item\r\n                    key={post.id}\r\n                    as={Link}\r\n                    to={`/post/${post.id}`}\r\n                    onClick={() => incrementViewCount(post.id)}\r\n                  >\r\n                    <Image src={post.imageUrl} size=\"tiny\" />\r\n\r\n                    <Item.Content>\r\n                      <Item.Meta>\r\n                        {post.author.photoURL ? (\r\n                          <Image src={post.author.photoURL} width={25} />\r\n                        ) : (\r\n                          <Icon name=\"user circle\" size=\"small\" />\r\n                        )}\r\n                        {post.topic} • {post.author.name || \"匿名\"} •{\" \"}\r\n                        {post.cretedAt\r\n                          ? post.cretedAt.toDate().toLocaleString([], {\r\n                              year: \"numeric\",\r\n                              month: \"short\",\r\n                              day: \"numeric\",\r\n                              hour: \"2-digit\",\r\n                              minute: \"2-digit\",\r\n                            })\r\n                          : \"2021-10-10 08:00 AM\"}\r\n                      </Item.Meta>\r\n\r\n                      <Item.Header>{post.title}</Item.Header>\r\n                      <Item.Description>{post.content}</Item.Description>\r\n                      <Item.Extra>\r\n                        修改次數 : {post.updateCount || 0}\r\n                        觀看次數 : {post.viewCount || 0}\r\n                      </Item.Extra>\r\n                    </Item.Content>\r\n                  </Item>\r\n                );\r\n              })}\r\n            </Item.Group>\r\n          </Grid.Column>\r\n        </Grid.Row>\r\n      </Grid>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default Post;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}