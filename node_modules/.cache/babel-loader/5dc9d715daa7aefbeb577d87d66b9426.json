{"ast":null,"code":"import _slicedToArray from \"/Users/benwang/Desktop/NYCU_CS/112spring/cloud/final/Cloudnative_Final_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/benwang/Desktop/NYCU_CS/112spring/cloud/final/Cloudnative_Final_project/src/pages/Version.js\";\nimport { Image, Header, Segment, Button } from \"semantic-ui-react\";\nimport firebase from \"../utils/firebase\";\nimport React from \"react\";\nimport { useParams, Link } from \"react-router-dom\";\nimport \"firebase/firestore\";\nimport { version } from \"react/cjs/react.production.min\";\nfunction Version(_ref) {\n  var versionId = _ref.versionId;\n  var _useParams = useParams(),\n    postId = _useParams.postId;\n  var _React$useState = React.useState({\n      author: {}\n    }),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    post = _React$useState2[0],\n    setPost = _React$useState2[1];\n  React.useEffect(function () {\n    if (versionId) {\n      firebase.firestore().collection(\"posts\").doc(postId).collection(\"versions\").doc(versionId).get().then(function (docSnapshot) {\n        var data = docSnapshot.data();\n        setPost({\n          title: data.title,\n          content: data.content,\n          imageUrl: data.imageUrl,\n          author: data.author,\n          viewCount: data.viewCount || 0,\n          updateCount: data.updateCount || 0,\n          cretedAt: data.cretedAt || new Date() // 使用默認值\n        });\n      });\n    } else {\n      firebase.firestore().collection(\"posts\").doc(postId).get().then(function (docSnapshot) {\n        var data = docSnapshot.data();\n        setPost({\n          title: data.title,\n          content: data.content,\n          imageUrl: data.imageUrl,\n          author: data.author,\n          viewCount: data.viewCount || 0,\n          updateCount: data.updateCount || 0,\n          cretedAt: data.cretedAt || new Date() // 使用默認值\n        });\n      });\n    }\n  }, [postId]);\n  function onDelete(id) {\n    firebase.firestore().collection(\"posts\").doc(id).delete().then(function () {\n      alert(\"刪除成功\");\n    });\n  }\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: \"flex\",\n      alignItems: \"center\",\n      marginBottom: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Image, {\n    src: post.author.photoURL,\n    size: \"tiny\",\n    style: {\n      marginRight: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h5\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 11\n    }\n  }, \"\\u7248\\u672C\\u4FEE\\u6539\\u4EBA\\u54E1 / \\u6642\\u9593 :\"), post.author.displayName || \"匿名 / \", \"    \", post.cretedAt ? post.cretedAt.toDate().toLocaleString([], {\n    year: \"numeric\",\n    month: \"short\",\n    day: \"numeric\",\n    hour: \"2-digit\",\n    minute: \"2-digit\"\n  }) : \"2021-10-10 08:00 AM\")), /*#__PURE__*/React.createElement(Segment, {\n    basic: true,\n    vertical: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }\n  }, \"\\u89C0\\u770B\\u6B21\\u6578: \", post.viewCount || 0, \"\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0 \\u66F4\\u6539\\u6B21\\u6578:\", \" \", post.updateCount || 0), /*#__PURE__*/React.createElement(Header, {\n    as: \"h1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }\n  }, post.title), /*#__PURE__*/React.createElement(Image, {\n    src: post.imageUrl,\n    size: \"large\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Segment, {\n    basic: true,\n    vertical: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }\n  }, post.content), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    basic: true,\n    as: Link,\n    to: versionId ? \"modify/\".concat(versionId) : \"modify\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 9\n    }\n  }, \"\\u66F4\\u6539\\u6587\\u7AE0\"), /*#__PURE__*/React.createElement(Button, {\n    color: \"red\",\n    onClick: function onClick() {\n      return onDelete(post.id);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 9\n    }\n  }, \"\\u522A\\u9664\\u6587\\u7AE0\")));\n}\nexport default Version;","map":{"version":3,"names":["Image","Header","Segment","Button","firebase","React","useParams","Link","version","Version","_ref","versionId","_useParams","postId","_React$useState","useState","author","_React$useState2","_slicedToArray","post","setPost","useEffect","firestore","collection","doc","get","then","docSnapshot","data","title","content","imageUrl","viewCount","updateCount","cretedAt","Date","onDelete","id","delete","alert","createElement","Fragment","style","display","alignItems","marginBottom","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","src","photoURL","size","marginRight","displayName","toDate","toLocaleString","year","month","day","hour","minute","basic","vertical","as","to","concat","color","onClick"],"sources":["/Users/benwang/Desktop/NYCU_CS/112spring/cloud/final/Cloudnative_Final_project/src/pages/Version.js"],"sourcesContent":["import { Image, Header, Segment, Button } from \"semantic-ui-react\";\nimport firebase from \"../utils/firebase\";\nimport React from \"react\";\nimport { useParams, Link } from \"react-router-dom\";\nimport \"firebase/firestore\";\nimport { version } from \"react/cjs/react.production.min\";\n\nfunction Version({ versionId }) {\n  const { postId } = useParams();\n  const [post, setPost] = React.useState({\n    author: {},\n  });\n  React.useEffect(() => {\n    if (versionId) {\n      firebase\n        .firestore()\n        .collection(\"posts\")\n        .doc(postId)\n        .collection(\"versions\")\n        .doc(versionId)\n        .get()\n        .then((docSnapshot) => {\n          const data = docSnapshot.data();\n          setPost({\n            title: data.title,\n            content: data.content,\n            imageUrl: data.imageUrl,\n            author: data.author,\n            viewCount: data.viewCount || 0,\n            updateCount: data.updateCount || 0,\n            cretedAt: data.cretedAt || new Date(), // 使用默認值\n          });\n        });\n    } else {\n      firebase\n        .firestore()\n        .collection(\"posts\")\n        .doc(postId)\n        .get()\n        .then((docSnapshot) => {\n          const data = docSnapshot.data();\n          setPost({\n            title: data.title,\n            content: data.content,\n            imageUrl: data.imageUrl,\n            author: data.author,\n            viewCount: data.viewCount || 0,\n            updateCount: data.updateCount || 0,\n            cretedAt: data.cretedAt || new Date(), // 使用默認值\n          });\n        });\n    }\n  }, [postId]);\n\n  function onDelete(id) {\n    firebase\n      .firestore()\n      .collection(\"posts\")\n      .doc(id)\n      .delete()\n      .then(() => {\n        alert(\"刪除成功\");\n      });\n  }\n  return (\n    <>\n      <div\n        style={{\n          display: \"flex\",\n          alignItems: \"center\",\n          marginBottom: \"1rem\",\n        }}\n      >\n        <Image\n          src={post.author.photoURL}\n          size=\"tiny\"\n          style={{ marginRight: \"1rem\" }}\n        />\n        <div>\n          <h5>版本修改人員 / 時間 :</h5>\n          {post.author.displayName || \"匿名 / \"}\n          {\"    \"}\n          {post.cretedAt\n            ? post.cretedAt.toDate().toLocaleString([], {\n                year: \"numeric\",\n                month: \"short\",\n                day: \"numeric\",\n                hour: \"2-digit\",\n                minute: \"2-digit\",\n              })\n            : \"2021-10-10 08:00 AM\"}\n        </div>\n      </div>\n      <Segment basic vertical>\n        觀看次數: {post.viewCount || 0}\n        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 更改次數:{\" \"}\n        {post.updateCount || 0}\n      </Segment>\n\n      <Header as=\"h1\">\n        {/* <h1>Title</h1> */}\n        {post.title}\n      </Header>\n      <Image src={post.imageUrl} size=\"large\" />\n      <Segment basic vertical>\n        {post.content}\n      </Segment>\n\n      <div>\n        <Button\n          basic\n          as={Link}\n          to={versionId ? `modify/${versionId}` : `modify`}\n        >\n          更改文章\n        </Button>\n        <Button color=\"red\" onClick={() => onDelete(post.id)}>\n          刪除文章\n        </Button>\n      </div>\n    </>\n  );\n}\n\nexport default Version;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}